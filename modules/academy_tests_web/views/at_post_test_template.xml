<?xml version="1.0" encoding="UTF-8"?>

<openerp>
    <data noupdate="0">

        <!-- ROUTE posted-test GLOBAL LAYOUT
        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

        <template id="at_post_test" name="at_post_test">
            <t t-call="website.layout">

                <t t-set="title" t-value="at_test_id.name" />

                <div class="oe_structure">
                    <div class="container">
                        <div class="row">

                            <section class="posted-test-body col-xs-12 ">
                                <header class="page-header at-test-header hidden-print">
                                    <h2 class="at-test-name"><t t-esc="at_test_id.name" /></h2>

                                    <t t-if="at_test_id.description">

                                    <p class="at-test-description"><t t-esc="at_test_id.description" /></p>

                                    </t>

                                </header>

                                <div class="at-test-opcions-row">
                                    <!-- TOOLBAR:: BEGIN -->
                                    <div class="at-test-options btn-group btn-group-sm hidden-print " role="group" aria-label="Options">
                                        <button type="button" class="btn btn-default" title="Print" onclick="window.print();">
                                            <i class="fa fa-print text-info" aria-hidden="true"></i>
                                        </button>
                                        <button type="button" class="btn btn-default" title="Download all">
                                            <i class="fa fa-download text-active" aria-hidden="true"></i>
                                        </button>
                                        <button type="button" class="btn btn-default" title="Like">
                                            <i class="fa fa-thumbs-o-up text-success" aria-hidden="true"></i>
                                        </button>
                                    </div>
                                    <!-- TOOLBAR:: END -->
                                </div>

                                <ol class="at-question-ids">

                                    <t t-foreach="at_test_id.at_test_at_question_ids" t-as="at_test_at_question_ids">

                                    <!-- define ``question`` variable will be used in subtemplates -->
                                    <t t-set="at_question_id" t-value="at_test_at_question_ids.at_question_id" />

                                    <li class="at-question" t-attf-id="at-question-{{ at_question_id.id }}" t-attf-data-question-id="{{ at_question_id.id }}">
                                        <article>

                                            <t t-if="at_question_id.preamble">
                                                <p class="at-question-preamble"><t t-esc="at_question_id.preamble" /></p>
                                            </t>

                                            <!-- IMAGE-ATTACHMENTS:: BEGIN -->
                                            <t t-foreach="at_question_id.ir_attachment_image_ids" t-as="ir_attachment_image_id">
                                            <div class="ir-attachment-image-ids row">
                                                <div class="col-xs-12 col-sm-6 col-md-3">
                                                    <figure class="ir-attachment-image figure img-thumbnail">
                                                            <img class="img-responsive ir-attachment-image-datas"
                                                                t-attf-src="web/binary/download_document?id={{ ir_attachment_image_id.id }}"
                                                                alt="A caption for the above image text."
                                                                title="A caption for the above image text." />
                                                        <figcaption class="figure-caption ir-attachment-image-name"
                                                            t-attf-title="{{ ir_attachment_image_id.name }}">
                                                            <t t-esc="ir_attachment_image_id.name" />
                                                        </figcaption>
                                                    </figure>
                                                </div>
                                            </div>
                                            </t>
                                            <!-- IMAGE-ATTACHMENTS:: END -->

                                            <!-- TOOLBAR:: BEGIN -->
                                            <div class="at-question-options btn-group btn-group-xs hidden-print " role="group" aria-label="Options">
                                                <button type="button" class="btn btn-default btn-revise-question" title="Revise" t-attf-data-question-id="{{ at_question_id.id }}" >
                                                    <i class="fa fa-check-square-o text-success" aria-hidden="true"></i>
                                                </button>

                                                <t t-if="at_question_id.description">

                                                <button type="button"
                                                    data-toggle="popover"
                                                    data-placement="right"
                                                    class="btn btn-default btn-describe-question"
                                                    t-attf-data-question-id="{{ at_question_id.id }}"
                                                    t-attf-title="Description"
                                                    t-attf-data-content="{{ at_question_id.description }}">
                                                    <i class="fa fa-info text-info" aria-hidden="true"></i>
                                                </button>

                                                </t>

                                                <button type="button" class="btn btn-default btn-impugn-question"
                                                    data-toggle="modal"
                                                    data-target="#at-post-test-inpugnment-modal"
                                                    title="Impugn"
                                                    t-attf-data-question-id="{{ at_question_id.id }}">
                                                    <i class="fa fa-fire text-danger" aria-hidden="true"></i>&#160;
                                                </button>
                                                <button type="button" class="btn btn-default btn-edit-question" title="Edit" t-attf-data-question-id="{{ at_question_id.id }}">
                                                    <i class="fa fa-pencil-square-o text-active" aria-hidden="true"></i>
                                                </button>
                                            </div>
                                            <!-- TOOLBAR:: END -->

                                            <p class="at-question-name"><t t-esc="at_question_id.name" /></p>
                                            <ol class="at-answer-ids">

                                                <t t-foreach="at_question_id.at_answer_ids" t-as="at_answer_id">

                                                <li class="at-answer" t-attf-id="at-question-{{ at_answer_id.id }}" t-attf-correct="{{ at_answer_id.is_correct }}">
                                                    <t t-esc="at_answer_id.name" />
                                                    <t t-if="at_answer_id.is_correct==True">
                                                        <span class="text-success fa fa-check at-answer-iscorrect-checkmark" style="display: none" />
                                                        <!-- NOTE: initial display must be none, later it can be shown with jquery.show() -->
                                                    </t>
                                                </li>

                                                </t>

                                            </ol>
                                        </article>
                                    </li>

                                    <hr class="hidden-print" />

                                    </t><!-- at_test_at_question_ids -->

                                </ol>
                            </section>

                        </div>
                    </div><!-- container -->
                </div> <!-- oe_structure -->

                <t t-call="academy_tests_web.at_post_test_inpugnment_modal" />
                <t t-call="academy_tests_web.at_post_test_inpugnment_modal_result" />

                <script type="text/javascript" src="/web/static/lib/bootstrap/js/tooltip.js"></script>
                <script type="text/javascript" src="/web/static/lib/bootstrap/js/popover.js"></script>
                <script type="text/javascript" src="/academy_tests_web/static/src/js/at_post_test_template.js"></script>

            </t>
        </template>



        <!-- ROUTE posted-test IMPUGNMENT MODAL DIALOG
             Bootstrap modal dialog code: http://getbootstrap.com/javascript/#modals
        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

        <template id="at_post_test_inpugnment_modal">

            <t t-name="caca">
            <div class="modal fade no-print impugnment-dialog" tabindex="-1" role="dialog" id="at-post-test-inpugnment-modal">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&#215;</span></button>
                            <h4 class="modal-title">Impugn question #<span class="at-question-inpugment-at-question-id"></span></h4>
                        </div>
                        <div class="modal-body">
                            <form id="impugnment-form" name="impugnment-form">
                                <input type="hidden" name="at-question-inpugment-at-question-id" />
                                <input type="hidden" name="csrf_token" id="csrf_token" t-att-value="request.csrf_token()"/>

                                <div class="form-group">
                                    <label for="name">Title</label>
                                    <input type="text"
                                        class="form-control at-question-inpugment-name"
                                        name="at-question-inpugment-name"
                                        placeholder="Required title"
                                        required="required"></input>
                                </div>
                                <div class="form-group">
                                    <label for="description">Description</label>
                                    <textarea
                                        class="form-control at-question-inpugment-description"
                                        rows="6"
                                        name="at-question-inpugment-description"
                                        placeholder="Something about"
                                        style="resize:vertical; width: 100%;"></textarea>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default at-question-discard" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary at-question-send">Send</button>
                        </div>
                    </div><!-- /.modal-content -->
                </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
            </t>

        </template>



        <!-- ROUTE posted-test IMPUGNMENT AJAX RESULT DIALOG
             Bootstrap modal dialog code: http://getbootstrap.com/javascript/#modals
        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

        <template id="at_post_test_inpugnment_modal_result">

            <div class="modal fade no-print" tabindex="-1" role="dialog" id="impugnment-result-modal">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">

                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&#215;</span></button>
                            <h4 class="modal-title">Inpugnment result</h4>
                        </div>

                        <div class="modal-body impugnment-result-message">
                            <p>New ticket with id <strong class="impugnment-result-modal-at-question-inpugment-id"></strong> has been created.</p>
                            <dl>
                                <dt>Question:</dt>
                                <dd class="impugnment-result-modal-at-question-id"></dd>
                                <dt>Title:</dt>
                                <dd class="impugnment-result-modal-name"></dd>
                                <dt>Description:</dt>
                                <dd class="impugnment-result-modal-description"></dd>
                            </dl>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
                        </div>

                    </div><!-- /.modal-content -->
                </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->

        </template>



    </data>
</openerp>
