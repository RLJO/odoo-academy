<?xml version="1.0" encoding="UTF-8"?>

<openerp>
    <data noupdate="0">

        <!-- ROUTE posted-test GLOBAL LAYOUT
        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

        <template id="at_post_test" name="at_post_test">
            <t t-call="website.layout">

                <t t-set="title" t-value="at_test_id.name" />

                <div class="oe_structure">
                    <div class="container">
                        <div class="row">

                            <section class="posted-test-body col-xs-12 ">
                                <header class="page-header at-test-header hidden-print">
                                    <h2 class="at-test-name"><t t-esc="at_test_id.name" /></h2>

                                    <t t-if="at_test_id.description">

                                    <p class="at-test-description"><t t-esc="at_test_id.description" /></p>

                                    </t>

                                </header>

                                <div class="at-test-opcions-row">
                                    <!-- TOOLBAR:: BEGIN -->
                                    <div class="at-test-options btn-group btn-group-sm hidden-print " role="group" aria-label="Options">
                                        <button type="button" class="btn btn-default" title="Print" onclick="window.print();">
                                            <i class="fa fa-print text-info" aria-hidden="true"></i>
                                        </button>
                                        <button type="button" class="btn btn-default" title="Download all">
                                            <i class="fa fa-download text-active" aria-hidden="true"></i>
                                        </button>
                                        <button type="button" class="btn btn-default" title="Like">
                                            <i class="fa fa-thumbs-o-up text-success" aria-hidden="true"></i>
                                        </button>
                                    </div>
                                    <!-- TOOLBAR:: END -->
                                </div>

                                <ol class="at-question-ids">

                                    <t t-foreach="at_test_id.at_test_at_question_ids" t-as="at_test_at_question_ids">

                                    <!-- define ``question`` variable will be used in subtemplates -->
                                    <t t-set="at_question_id" t-value="at_test_at_question_ids.at_question_id" />

                                    <li class="at-question">
                                        <article>

                                            <t t-if="at_question_id.preamble">
                                                <p class="at-question-preamble"><t t-esc="at_question_id.preamble" /></p>
                                            </t>
                                            <!-- IMAGE-ATTACHMENTS:: BEGIN -->
                                            <t t-foreach="at_question_id.ir_attachment_image_ids" t-as="ir_attachment_image_id">
                                            <div class="ir-attachment-image-ids row">
                                                <div class="col-xs-12 col-sm-6 col-md-3">
                                                    <figure class="ir-attachment-image figure img-thumbnail">
                                                            <img class="img-responsive ir-attachment-image-datas"
                                                                t-attf-src="web/binary/download_document?id={{ ir_attachment_image_id.id }}"
                                                                alt="A caption for the above image text."
                                                                title="A caption for the above image text." />
                                                        <figcaption class="figure-caption ir-attachment-image-name"
                                                            t-attf-title="{{ ir_attachment_image_id.name }}">
                                                            <t t-esc="ir_attachment_image_id.name" />
                                                        </figcaption>
                                                    </figure>
                                                </div>
                                            </div>
                                            </t>

                                            <!-- TOOLBAR:: BEGIN -->
                                            <div class="at-question-options btn-group btn-group-xs hidden-print " role="group" aria-label="Options">
                                                <button type="button" class="btn btn-default btn-revise-question" title="Revise" t-attf-data-question-id="{{ at_question_id.id }}" >
                                                    <i class="fa fa-check-square-o text-success" aria-hidden="true"></i>
                                                </button>
                                                <button type="button" class="btn btn-default btn-describe-question" title="Description" t-attf-data-question-id="{{ at_question_id.id }}">
                                                    <i class="fa fa-info text-info" aria-hidden="true"></i>
                                                </button>
                                                <button type="button" class="btn btn-default btn-impugn-question" title="Impugn" t-attf-data-question-id="{{ at_question_id.id }}">
                                                    <i class="fa fa-fire text-danger" aria-hidden="true"></i>&#160;
                                                </button>
                                                <button type="button" class="btn btn-default btn-edit-question" title="Edit" t-attf-data-question-id="{{ at_question_id.id }}">
                                                    <i class="fa fa-pencil-square-o text-active" aria-hidden="true"></i>
                                                </button>
                                            </div>
                                            <!-- TOOLBAR:: END -->

                                            <p class="at-question-name"><t t-esc="at_question_id.name" /></p>
                                            <ol class="at-answer-ids">

                                                <t t-foreach="at_question_id.at_answer_ids" t-as="at_answer_id">

                                                <li class="at-answer">
                                                    <t t-esc="at_answer_id.name" />
                                                    <t t-if="at_answer_id.is_correct==True">
                                                        <span class="text-success fa fa-check" style="display: none" />
                                                        <!-- NOTE: initial display must be none, later it can be shown with jquery.show() -->
                                                    </t>
                                                </li>

                                                </t>

                                            </ol>
                                        </article>
                                    </li>

                                    <hr class="hidden-print" />

                                    </t><!-- at_test_at_question_ids -->

                                </ol>
                            </section>

                        </div>
                    </div><!-- container -->
                </div> <!-- oe_structure -->

                <script type="text/javascript" src="/academy_tests_web/static/src/js/at_post_test_template.js"></script>

            </t>
        </template>


        <!-- ROUTE posted-test QUESTION BLOCK
        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

        <template id="at_post_test_question_show" name="Post a single test">
            <t t-if="question.preamble">
            <p class="at-question-preamble"><t t-esc="question.preamble" /></p>
            </t>
            <p>
                <span data-toggle="tooltip" data-placement="top" t-att-title="question.description"><t t-esc="question.name" /></span>
                <t t-if="question.description">
                    <span class="no-print text-info fa fa-info" data-toggle="tooltip" data-placement="top" t-att-title="question.description" />
                </t>
                &#160;
                <button onclick="showRightAnswer(this);" ondblclick="showRightAnswers(this);" data-action="show-right-answers" title="Show the right answer" class="btn btn-icon">
                    <span class="no-print text-active fa fa-check-square-o" />
                </button>
                <button onclick="showInpugnmentDialog(this);" data-action="show-inpugnment-dialog" data-toggle="modal" data-target="#impugnment-modal" title="Impugn this question" class="btn btn-icon">
                    <span class="no-print text-danger fa fa-fire" />
                </button>
                <t t-if="edit == True">
                    <button onclick="editQuestion(this);" data-action="edit-question" t-att-data-question-id="question.id" title="Edit this question" class="btn btn-icon">
                        <span class="no-print text-info fa fa-pencil-square-o" />
                    </button>
                </t>
            </p>
            <ol>
                <t t-foreach="question.at_answer_ids" t-as="answer_id">
                <li class="at-post-test-answer" t-att-data-id="answer_id.id" t-att-data-right="answer_id.is_correct">
                    <p data-toggle="tooltip" data-placement="top" t-att-title="answer_id.description">
                        <t t-esc="answer_id.name" />
                        <t t-if="answer_id.is_correct==True">
                            <span class="text-success fa fa-check" style="display: none" />
                            <!-- NOTE: initial display must be none, later it can be shown with jquery.show() -->
                        </t>
                    </p>
                </li>
                </t>
            </ol>
        </template>


        <!-- ROUTE posted-test QUESTION EDIT BLOCK
        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

        <template id="at_post_test_question_edit" name="Post a single test">
            <form class="at-post-test-question-edit">
                <p>
                    <textarea class="form-control" rows="2" name="preamble" id="preamble" placeholder="Text for preamble" style="resize:vertical; width: 100%;"><t t-esc="question.preamble" /></textarea>
                    <textarea type="text" class="form-control" id="name"
                        placeholder="Required title" required="required"><t t-esc="question.name" /></textarea>

                    <textarea class="form-control" rows="2" name="description" id="description" placeholder="Something about" style="resize:vertical; width: 100%;"><t t-esc="question.description" /></textarea>
                </p>
                <ol>
                    <t t-foreach="question.at_answer_ids" t-as="answer_id">
                    <li class="at-post-test-answer" t-att-data-id="answer_id.id" t-att-data-right="answer_id.is_correct" style="position: relative;">
                            <input type="text" class="form-control" id="name"
                                placeholder="Required title" required="required"
                                t-att-value="answer_id.name" />
                            <t t-if="answer_id.is_correct==True" style="position: absolute; left: -20px; top: 0px">
                                <input type="checkbox" checked="checked"></input>
                            </t>
                            <t t-if="answer_id.is_correct!=True">
                                <input type="checkbox" style="position: absolute; left: -20px; top: 0px"></input>
                            </t>
                    </li>
                    </t>
                </ol>
            </form>
            <div class="at-question-edit-footer" style="margin-top: 1em">
                <button  data-action="discard-question" onclick="discardQuestion(this);" t-att-data-question-id="question.id" type="button" class="btn btn-default" data-dismiss="modal">Discard</button>
                <button data-action="save-question"  onclick="saveQuestion(this);" t-att-data-question-id="question.id" type="button" class="btn btn-primary btn-at-question-save">Save</button>
            </div>
        </template>


        <!-- ROUTE posted-test IMPUGNMENT MODAL DIALOG
             Bootstrap modal dialog code: http://getbootstrap.com/javascript/#modals
        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

        <template id="at_post_test_inpugnment_modal">
            <div class="modal fade no-print" tabindex="-1" role="dialog" id="impugnment-modal">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&#215;</span></button>
                            <h4 class="modal-title">Impugnment </h4>
                        </div>
                        <div class="modal-body">
                            <form id="impugnment-form" name="impugnment-form">
                                <input type="hidden" id="question_id" />
                                <input type="hidden" id="csrf_token" name="csrf_token" t-att-value="request.csrf_token()"/>

                                <div class="form-group">
                                    <label for="name">Title</label>
                                    <input type="text" class="form-control" id="name" placeholder="Required title" required="required"></input>
                                </div>
                                <div class="form-group">
                                    <label for="description">Description</label>
                                    <textarea class="form-control" rows="6" name="description" id="description" placeholder="Something about" style="resize:vertical; width: 100%;"></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="attachment">Attachement</label>
                                    <input type="file" id="attachment"></input>
                                    <p class="help-block">You can attach a file or screen capture</p>
                                </div>
                                <div class="checkbox">
                                    <label>
                                        <input type="checkbox"></input> I like to receive reply
                                    </label>
                                </div>
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary">Send</button>
                        </div>
                    </div><!-- /.modal-content -->
                </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
        </template>


        <!-- ROUTE posted-test IMPUGNMENT AJAX RESULT DIALOG
             Bootstrap modal dialog code: http://getbootstrap.com/javascript/#modals
        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

        <template id="at_post_test_inpugnment_modal_result">
            <div class="modal fade no-print" tabindex="-1" role="dialog" id="impugnment-result-modal">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&#215;</span></button>
                            <h4 class="modal-title">Inpugnment result</h4>
                        </div>
                        <div class="modal-body">
                            <p id="impugnment-result-message"></p>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
                        </div>
                    </div><!-- /.modal-content -->
                </div><!-- /.modal-dialog -->
            </div><!-- /.modal -->
        </template>


        <!-- ROUTE posted-test IMPUGNMENT AJAX RESULT TEXT
        - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

        <template id="at_post_test_impugnment_response" name="Post a single test">
            Your inpugnment <b>«<t t-esc="inpugnment['name']" />»</b>
            for question <b>«<t t-esc="inpugnment['question_id']" />»</b>
            with description «<i><t t-esc="inpugnment['description']" /></i>»
            has been processed.
        </template>

    </data>
</openerp>
